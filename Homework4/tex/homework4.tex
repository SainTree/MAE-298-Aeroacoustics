\documentclass[onecolumn,10pt]{jhwhw}

\usepackage{epsfig} %% for loading postscript figures
\usepackage{amsmath}
\usepackage{graphicx}
\usepackage{grffile}
\usepackage{pdfpages}
\usepackage{algpseudocode}
\usepackage{wrapfig}
\usepackage{booktabs}
\usepackage{multicol}
\usepackage{cancel}
% \usepackage{geometry}
% \geometry{margin=0.75in}

% Default fixed font does not support bold face
\DeclareFixedFont{\ttb}{T1}{txtt}{bx}{n}{12} % for bold
\DeclareFixedFont{\ttm}{T1}{txtt}{m}{n}{12}  % for normal

% Custom colors
\usepackage{color}
\usepackage{listings}
\usepackage{framed}
\usepackage{caption}
\usepackage{bm}
\captionsetup[lstlisting]{font={small,tt}}

\definecolor{mygreen}{rgb}{0,0.6,0}
\definecolor{mygray}{rgb}{0.5,0.5,0.5}
\definecolor{mymauve}{rgb}{0.58,0,0.82}

\lstset{ %
  backgroundcolor=\color{white},   % choose the background color; you must add \usepackage{color} or \usepackage{xcolor}
  basicstyle=\ttfamily\footnotesize, % the size of the fonts that are used for the code
  breakatwhitespace=false,         % sets if automatic breaks should only happen at whitespace
  % breaklines=true,                 % sets automatic line breaking
  captionpos=b,                    % sets the caption-position to bottom
  commentstyle=\color{mygreen},    % comment style
  deletekeywords={...},            % if you want to delete keywords from the given language
  escapeinside={\%*}{*)},          % if you want to add LaTeX within your code
  extendedchars=true,              % lets you use non-ASCII characters; for 8-bits encodings only, does not work with UTF-8
  frame=single,                    % adds a frame around the code
  keepspaces=true,                 % keeps spaces in text, useful for keeping indentation of code (possibly needs columns=flexible)
  columns=flexible,
  keywordstyle=\color{blue},       % keyword style
  language=Python,                 % the language of the code
  morekeywords={*,...},            % if you want to add more keywords to the set
  numbers=left,                    % where to put the line-numbers; possible values are (none, left, right)
  numbersep=5pt,                   % how far the line-numbers are from the code
  numberstyle=\tiny\color{mygray}, % the style that is used for the line-numbers
  rulecolor=\color{black},         % if not set, the frame-color may be changed on line-breaks within not-black text (e.g. comments (green here))
  showspaces=false,                % show spaces everywhere adding particular underscores; it overrides 'showstringspaces'
  showstringspaces=false,          % underline spaces within strings only
  showtabs=false,                  % show tabs within strings adding particular underscores
  stepnumber=1,                    % the step between two line-numbers. If it's 1, each line will be numbered
  stringstyle=\color{mymauve},     % string literal style
  tabsize=4,                       % sets default tabsize to 2 spaces
}

\author{John Karasinski}
\title{EAE 298 Aeroacoustics \\ Fall Quarter 2016 \\ Homework \#4}

\begin{document}
\maketitle

You are designing a new aircraft engine and analyzing acoustic propagation generated by a non-uniform flow with angle of attack interacting with rotating fans. You obtained flow fields from CFD for a one-sixth small scale of the engine. The radius for the small scale engine is 13 in and the hub radius is 3 in. CFD provides the velocity gust information as a function of its circumferential modes. The circumferential mode for acoustics can be expressed as $m= nB - kV$ where $B$ is the number of blades, $V$ is the number of vanes, $n$ stands for the harmonic of BPF and $k$ is the integer (1, 2, 3$\ldots$). You consider only positive k at this time (this is related the rotation direction of gust). The number of blades is 18. The number of vanes is considered to be 1 since there is no physical vanes but there is one revolution difference. The Mach number is 0.525 and the fan RPM is 8326.3042, the speed of sound is 13503.937009 in/s and the density is 1.4988E-5 slug/in$^3$. The dominant noise is generated at the 1st BPF or n=1 in which the angular frequency is given as $RPM \times \frac{2 \pi}{60} \times B$. We are interested in the propagation through the inlet of the engine so that sound propagates to -z direction assuming the +z direction is in the flow direction.

\problem{[20 points]}
Determine the first five eigenvalues of acoustics for m=18, 17, 16, 15 or (k=1, 2, 3, 4) or (m,n) = (18,0), (18,1), (18,2), (18,3), (18,4), (17,0), (17,1), (17,2), (17,3), (17,4), (16,0), (16,1), (16,2), (16,3), (16,4), (15,0), (15,1), (15,2), (15,3), (15,4).

\begin{figure*}[h]
\centering
\begin{tabular}{l | rrrr}
\toprule
  &         &         &         &       m \\
n &      15 &      16 &      17 &      18 \\
\midrule
0 &  1.3093 &  1.3895 &  1.4696 &  1.5495 \\
1 &  1.7032 &  1.7896 &  1.8755 &  1.9612 \\
2 &  2.0137 &  2.1036 &  2.1932 &  2.2823 \\
3 &  2.3005 &  2.3932 &  2.4855 &  2.5772 \\
4 &  2.5753 &  2.6702 &  2.7646 &  2.8585 \\
\bottomrule
\end{tabular}
\caption{The first five eigenvalues of acoustics for m=$\{15, 16, 17, 18\}.$}
\end{figure*}

\clearpage
\problem{[20 points]}
Plot the five eigenfunctions (radial modes, n=0, 1, 2, 3, 4) for m=18, 17, 16, 15 or (k=1, 2, 3, 4) and verify n describes the number of zero crossings in the radial direction.

\begin{figure*}[h]
  \centering
  \includegraphics[width=\textwidth]{figs/problem2.pdf}%
  \caption{Eigenvalues for the first five radial modes for m=$\{15, 16, 17, 18\}$. Each radial mode has appropriate number of zero crossings.}%
  % \label{fig:fullfig}%
\end{figure*}

\clearpage
\problem{[20 points]}
Determine the wavenumbers in the z direction for (m,n)=(18,0), (18,1), (18,2), (17,0), (17,1), (17,2), (16,0), (16,1), (16,2), (15,0), (15,1), (15,2). Indicate whether the mode is cut-on (propagating) or cut-off (exponentially decaying). Consider only the propagation in the -z direction. Exclude the exponentially growing solution and include only the propagating solutions or exponentially decaying solutions.

\begin{figure*}[h]
\centering
\begin{tabular}{lr|rr|r}
\toprule
 m &  n &   $\mu$ &             $K_z$ &    Cut \\
\midrule
15 &  0 &  1.3093 & -0.386 +  0.000 i &    On  \\
15 &  1 &  1.7032 & -0.842 +  1.195 i &    Off \\
15 &  2 &  2.0137 & -0.842 +  1.738 i &    Off \\
\midrule
16 &  0 &  1.3895 & -0.842 +  0.301 i &    Off \\
16 &  1 &  1.7896 & -0.842 +  1.359 i &    Off \\
16 &  2 &  2.1036 & -0.842 +  1.880 i &    Off \\
\midrule
17 &  0 &  1.4696 & -0.842 +  0.638 i &    Off \\
17 &  1 &  1.8755 & -0.842 +  1.510 i &    Off \\
17 &  2 &  2.1932 & -0.842 +  2.016 i &    Off \\
\midrule
18 &  0 &  1.5495 & -0.842 +  0.860 i &    Off \\
18 &  1 &  1.9612 & -0.842 +  1.653 i &    Off \\
18 &  2 &  2.2823 & -0.842 +  2.148 i &    Off \\
\bottomrule
\end{tabular}
\caption{$K_z$ for combinations of m and n. All modes except for (m, n) = (15, 0) are cut-off.}
\end{figure*}

\problem{[30 points]}
The pressure distribution file at z=0 plane for m=18 or 1 BPF is provided. The first column is the dimensional radius [in], the second column the real part of the pressure [psi], and the third column is the imaginary part of the pressure [psi]. Using this boundary condition, compute the sound power level for (m,n)=(18,0), (18,1), (18,2). This noise is considered for blade self noise that is not associated with the gust response since k=0. Note that the z=0 plane is not the same as the engine inlet. Use the conversion for the unit for the sound power as follows: PWL (dB)=10*log10((Wmn))-10*log10(7.3756E-13).

\begin{figure*}[h]
\centering
\begin{tabular}{rr}
\toprule
n &         PWL (dB) \\
\midrule
  0 &  -10.4015 \\
  1 &  -13.3775 \\
  2 &  -22.3880 \\
\bottomrule
\end{tabular}
\caption{PWL (dB) for m=18. Negative values indicate that the sound power is below the reference pressure.}
\end{figure*}

\clearpage
\section{Code}
\lstinputlisting{../hw4.py}

\end{document}
